var Cachelee=require("cachelee"),cacheMachine=null;function requestHash(e){var a={method:e.method,params:e.params,query:e.query,baseUrl:e.baseUrl,originalUrl:e.originalUrl,url:e.url};return JSON.stringify(a)}function expressQuickleeMiddleware(e,a,r){var t=requestHash(e),s=cacheMachine.get(t);if(s)a.send(s);else{var n=a.send;a.send=function(e){cacheMachine.cache(t,e),n.apply(a,arguments)},r()}}module.exports=function(e){return e&&(e.strategy&&"lfu"===e.strategy.toLowerCase()?e.strategy=Cachelee.Strategy.LeastFrequentlyUsed:e.strategy&&"lru"===e.strategy.toLowerCase()?e.strategy=Cachelee.Strategy.LeastRecentlyUsed:e.strategy&&console.warn("Unknown strategy "+e.strategy+". Using default (LFU).")),cacheMachine=new Cachelee.Cache(e),expressQuickleeMiddleware};